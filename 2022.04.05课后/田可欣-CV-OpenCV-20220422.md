# 模型搭建

Created: April 26, 2022 11:06 PM

上课时间: April 22, 2022

# 深度学习流程

- 在训练集上进行训练，并在验证集上进行验证
- 模型可以保存最优的权重，并读取权重
- 记录下训练集和验证集的精度，便于调参

# CNN

## 特点

- CNN是解决图像分类、图像检索、物体检测和语义分割的主流模型
- 网络模型结构越深、网络参数越多模型的精度更优
- a

## 发展历史

![6-模型历史.jpg](https://github.com/kk37111754/Aliyun-CV/blob/ea23ff724104d1e70eb583727608f9ed702c4e4c/2022.04.05%E8%AF%BE%E5%90%8E/%E7%94%B0%E5%8F%AF%E6%AC%A3-%E8%B5%84%E6%96%99/pic/6-%E6%A8%A1%E5%9E%8B%E5%8E%86%E5%8F%B2.jpg)

## 使用Pytorch构建

- 定义好**模型的参数**和**正向传播**即可
- Pytorch会根据正向传播自动计算反向传播
- [pre-train函数模型引用及修改](https://blog.csdn.net/whut_ldz/article/details/78845947)
- [cuDNN，GPU加速库](https://zhuanlan.zhihu.com/p/333632424)

# 模型训练与验证

## 拟合规律

### 过拟合 Overfitting

模型如果将训练集学的过好，模型就会记住训练样本的细节，导致模型在测试集的泛化效果较差

- 模型复杂度（Model Complexity）太高：模型学习过于细节的规律

### 欠拟合 Underfitting

模型在训练集上的拟合效果较差

![loss.png](https://github.com/kk37111754/Aliyun-CV/blob/ea23ff724104d1e70eb583727608f9ed702c4e4c/2022.04.05%E8%AF%BE%E5%90%8E/%E7%94%B0%E5%8F%AF%E6%AC%A3-%E8%B5%84%E6%96%99/pic/6-loss.png)

### 规律

随着模型复杂度和模型训练轮数的增加，CNN模型在训练集上的误差会降低，但在测试集上的误差会逐渐降低，然后逐渐升高

### 解决方法

- 构建一个与测试集尽可能分布一致的样本集，即验证集
- 在训练过程中不断验证模型在验证集上的精度，并以此控制模型的训练
- **验证集的分布应该与测试集尽量保持一致**

## 数据分集

- 训练集（Train Set）：模型用于训练和调整模型参数
- 验证集（Validation Set）：用来验证模型精度和调整模型超参数
- 测试集（Test Set）：验证模型的泛化能力

## 划分本地验证集

### 留出法（Hold-Out）

**直接将训练集划分成两部分**，新的训练集和验证集

- 优点：最为直接简单
- 缺点：只得到了一份验证集，有可能导致模型在验证集上过拟合
- 应用场景是数据量比较大的情况

### 交叉验证法（Cross Validation，CV）

将训练集划分成K份，将其中的K-1份作为训练集，剩余的1份作为验证集，循环K训练

- 这种划分方式是所有的训练集都是验证集，**最终模型验证精度是K份平均得到**
- 优点：
  - 验证集精度比较可靠
  - 训练K次可以得到K个有多样性差异的模型
- 缺点：需要训练K次，不适合数据量很大的情况

### 自助采样法（BootStrap）

通过有放回的采样方式得到新的训练集和验证集，每次的训练集和验证集都是有区别的。这种划分方式一般适用于数据量较小的情况。

![验证集构造.png](https://github.com/kk37111754/Aliyun-CV/blob/ea23ff724104d1e70eb583727608f9ed702c4e4c/2022.04.05%E8%AF%BE%E5%90%8E/%E7%94%B0%E5%8F%AF%E6%AC%A3-%E8%B5%84%E6%96%99/pic/6-%E9%AA%8C%E8%AF%81%E9%9B%86%E6%9E%84%E9%80%A0.png)

# 模型调参

## 相关性

深度学习模型的精度与模型的复杂度、数据量、正则化、数据扩增等因素直接相关

## 调参方法

- 初步构建简单的CNN模型，不用特别复杂，跑通训练、验证和预测的流程
- 简单CNN模型的损失会比较大，尝试增加模型复杂度，并观察验证集精度
- 在**增加模型复杂度**的同时**增加数据扩增**方法，直至验证集精度不变

![调参流程.png](https://github.com/kk37111754/Aliyun-CV/blob/ea23ff724104d1e70eb583727608f9ed702c4e4c/2022.04.05%E8%AF%BE%E5%90%8E/%E7%94%B0%E5%8F%AF%E6%AC%A3-%E8%B5%84%E6%96%99/pic/6-%E8%B0%83%E5%8F%82%E6%B5%81%E7%A8%8B.png)
